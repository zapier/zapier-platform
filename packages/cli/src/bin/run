#!/usr/bin/env node

const path = require('node:path');

(async () => {
  const oclif = await import('@oclif/core');
  await oclif.execute({ development: false, dir: __dirname });

  // Show deprecation warning if invoked via the old "zapier" binary name
  const scriptPath = process.argv[1] || '';
  const binName = path.basename(scriptPath, path.extname(scriptPath));
  
  // DEBUG: Print values for Windows testing
  console.log('\n=== DEBUG INFO (Windows Testing) ===');
  console.log('process.argv[0]:', process.argv[0]);
  console.log('process.argv[1]:', process.argv[1]);
  console.log('scriptPath:', scriptPath);
  console.log('binName:', binName);
  console.log('Platform:', process.platform);
  console.log('process.ppid:', process.ppid);
  console.log('process.title:', process.title);
  
  // Check for custom env variables we could inject via wrapper scripts
  console.log('\nChecking for custom env variables:');
  console.log('process.env.ZAPIER_BIN_NAME:', process.env.ZAPIER_BIN_NAME);
  console.log('process.env._ZAPIER_BIN:', process.env._ZAPIER_BIN);
  
  console.log('===================================\n');
  
  if (binName === 'zapier') {
    console.warn(
      '[DEPRECATION WARNING] ' +
        'The executable name "zapier" is deprecated and will be removed in a future version. ' +
        'Please use "zapier-platform" instead.',
    );
  }
})();
